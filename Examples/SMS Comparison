
Real network examples
---------------------

Motorola -> Over the Air -> Hytera Direct -> USB -> PC
Motorola -> Over the Air -> Hytera Group -> USB -> PC

PC (hytera test software) -> USB -> Hytera -> Over the Air -> Motorola

These are from pcap files of the USB rndis network.
Data is transmitted as hex, but converted to binary and laid out here.

cai=12 (ip)
colour code = 12


Sending Device
Motorola          Motorola          Motorola to GRP   Motorola          Software          Hytera


00001001          00001001          00001001          00001001          00001001          00001001     1001=idle data? P=0 R=0 001001=FLCO ? 001001=8 bit ISO/IEC 8859-7 [10]? SAP 9 = Short Data Services over PDP?
10000000          10000000          10000000          10000000          00000000          10000000     
10100001          10100001          10110001          10100001          10100001          10100001     1010 rate1 data 1011 Unified Single Block Data ?

00000000          00000000          00000000          00000000          00000000          00000000     Standard FID 8x0 ?

00011010          00011010          00011010          00110010          00100110          00011000     

00000000          00000000          00000000          00000000          00110000          00000000     
00000000          00000000          00000000          00000000          00000000          00000000     
00000000          00000000          00000000          00000000          00000000          00000000     




00000001          00000001          00000001          00000001          00000010          00000001     

TO LLID 24bits but this looks 32 or at least 28
00001100 =12      00001100 =12      00000000          00001100 =12      00001100 =12      00001100 =12 
00111111 =63      00111111 =63      10101001 =169     00111111 =63      00010000 =16      00000000 =0  
00000101 =5       00000101 =5       10110010 =178     00000101 =5       00000110 =6       00000000 =0  
01111100 =124     01111100 =124     00100111 =39      01111100 =124     10101100 =172     00000001 =1  

FROM
00001100 =12      00001100 =12      00001100 =12      00001100 =12      00001100 =12      00001100 =12 
00010000 =16      00010000 =16      00010000 =16      00010000 =16      00111111 =63      00000001 =1  
00000110 =6       00000110 =6       00000110 =6       00000110 =6       00000101 =5       10110101 =181
10101100 =172     10110110 =182     10101100 =172     10101100 =172     01111100 =124     10101001 =169


00001101 =13      00001101          00001101          00001101          Missing           Missing            1101=DPF Short Data: Defined ?

00000000          00000000          00000000          00000000          Missing           Missing            144

00001010          00001010          00001010          00001010          Missing           Missing            1010 rate1 data ?

00000000          00000000          00000000          00000000          Missing           Missing            

Message - 5 data blocks                              17 data blocks    13 data blocks     6 data blocks

01010010 =R       01010010          01010010          01010000 =P       01001000 =H       01001000 =H
00000000          00000000          00000000          00000000          00000000          00000000
01100101 =e       01100101          01100101          01110101 =u       01100101 =e       01100101 =e
00000000          00000000          00000000          00000000          00000000          00000000
01100001 =a       01100001          01100001          01110100 =t       01101100 =l       01101100 =l
00000000          00000000          00000000          00000000          00000000          00000000
01100100 =d       01100100          01100100          00100000 ={Space} 01101100 =l       01101100 =l
00000000          00000000          00000000          00000000          00000000          00000000
01111001 =y       01111001          01111001          01110100 =t       01101111 =o       01101111 =o
00000000          00000000          00000000          00000000          00000000          00000000
                                                      01101000 =h       00100000 ={Space} 00100001 =!
                                                      00000000          00000000          00000000
                                                      01100101 =e       01000110 =F
                                                      00000000          00000000
                                                      00100000 ={Space} 01110010 =r
                                                      00000000          00000000
                                                      01001011 =K       01101111 =o
                                                      00000000          00000000
                                                      01100101 =e       01101101 =m
                                                      00000000          00000000
                                                      01110100 =t       00100000 ={Space}
                                                      00000000          00000000
                                                      01110100 =t       01010000 =P
                                                      00000000          00000000
                                                      01101100 =l       01000011 =C
                                                      00000000          00000000
                                                      01100101 =e
                                                      00000000
                                                      00100000 ={Space}
                                                      00000000
                                                      01001111 =O
                                                      00000000
                                                      01101110 =n
                                                      00000000

01010000          01000110          10001010          00101101          01000100          01101011      crc ? 9 bits ?
00000011          00000011          00000011          00000011          00000011          00000011      == End of Packet - 0011=Data packet with confirmed delivery?




Other Notes
-----------

SAP 4 = IP Packet
SAP 5 = IP over PDP
SAP 9 = Short Data Services over PDP

How do you encode source and destination ports (5016) into 3 bits?
All ETSI Documents say LLID = 24bits but these look 32.
I don't know if interleaving is already done.

